<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®ç®¡ç†åå° - å°±ä¸šç«äº‰åŠ›æµ‹è¯„ç³»ç»Ÿ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .stat-card {
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(52, 152, 219, 0.4);
        }
        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            transition: all 0.3s ease;
        }
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(231, 76, 60, 0.4);
        }
        .table-row {
            transition: all 0.3s ease;
        }
        .table-row:hover {
            background-color: rgba(52, 152, 219, 0.05);
        }
        .search-input {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .search-input:focus {
            border-color: #3498db;
            box-shadow: 0 0 20px rgba(52, 152, 219, 0.3);
        }
    </style>
</head>
<body class="py-8">
    <div class="container mx-auto px-4">
        <!-- å¤´éƒ¨æ ‡é¢˜ -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-4">æ•°æ®ç®¡ç†åå°</h1>
            <p class="text-white text-lg opacity-90">å°±ä¸šç«äº‰åŠ›æµ‹è¯„ç³»ç»Ÿæ•°æ®ç®¡ç†ä¸­å¿ƒ</p>
        </div>

        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="grid md:grid-cols-4 gap-6 mb-8">
            <div class="stat-card glass-card rounded-2xl p-6 shadow-2xl text-center">
                <div class="text-3xl font-bold text-blue-600 mb-2" id="totalUsers">-</div>
                <div class="text-gray-600">æ€»ç”¨æˆ·æ•°</div>
            </div>
            <div class="stat-card glass-card rounded-2xl p-6 shadow-2xl text-center">
                <div class="text-3xl font-bold text-green-600 mb-2" id="totalAssessments">-</div>
                <div class="text-gray-600">æµ‹è¯„æ¬¡æ•°</div>
            </div>
            <div class="stat-card glass-card rounded-2xl p-6 shadow-2xl text-center">
                <div class="text-3xl font-bold text-purple-600 mb-2" id="averageScore">-</div>
                <div class="text-gray-600">å¹³å‡åˆ†æ•°</div>
            </div>
            <div class="stat-card glass-card rounded-2xl p-6 shadow-2xl text-center">
                <div class="text-3xl font-bold text-orange-600 mb-2" id="completionRate">-</div>
                <div class="text-gray-600">å®Œæˆç‡</div>
            </div>
        </div>

        <!-- æ•°æ®å¯è§†åŒ– -->
        <div class="grid lg:grid-cols-2 gap-8 mb-8">
            <!-- åˆ†æ•°åˆ†å¸ƒå›¾ -->
            <div class="glass-card rounded-2xl p-8 shadow-2xl">
                <h3 class="text-xl font-bold text-gray-800 mb-6">åˆ†æ•°åˆ†å¸ƒç»Ÿè®¡</h3>
                <div id="scoreChart" style="height: 300px;"></div>
            </div>

            <!-- å¹´çº§åˆ†å¸ƒå›¾ -->
            <div class="glass-card rounded-2xl p-8 shadow-2xl">
                <h3 class="text-xl font-bold text-gray-800 mb-6">å¹´çº§åˆ†å¸ƒç»Ÿè®¡</h3>
                <div id="gradeChart" style="height: 300px;"></div>
            </div>
        </div>

        <!-- æœç´¢å’Œç­›é€‰ -->
        <div class="glass-card rounded-2xl p-6 shadow-2xl mb-8">
            <div class="flex flex-wrap gap-4 items-center">
                <div class="flex-1 min-w-[200px]">
                    <input type="text" id="searchInput" placeholder="æœç´¢å§“åæˆ–æ‰‹æœºå·..." 
                           class="search-input w-full px-4 py-2 rounded-lg text-gray-800 placeholder-gray-500 focus:outline-none">
                </div>
                <div class="min-w-[150px]">
                    <select id="gradeFilter" class="search-input w-full px-4 py-2 rounded-lg text-gray-800 focus:outline-none">
                        <option value="">æ‰€æœ‰å¹´çº§</option>
                        <option value="å¤§ä¸€">å¤§ä¸€</option>
                        <option value="å¤§äºŒ">å¤§äºŒ</option>
                        <option value="å¤§ä¸‰">å¤§ä¸‰</option>
                        <option value="å¤§å››">å¤§å››</option>
                        <option value="ç ”ä¸€">ç ”ä¸€</option>
                        <option value="ç ”äºŒ">ç ”äºŒ</option>
                        <option value="ç ”ä¸‰">ç ”ä¸‰</option>
                        <option value="åšä¸€">åšä¸€</option>
                        <option value="åšäºŒ">åšäºŒ</option>
                        <option value="åšä¸‰">åšä¸‰</option>
                        <option value="åšå››">åšå››</option>
                    </select>
                </div>
                <div class="min-w-[150px]">
                    <select id="scoreFilter" class="search-input w-full px-4 py-2 rounded-lg text-gray-800 focus:outline-none">
                        <option value="">æ‰€æœ‰åˆ†æ•°</option>
                        <option value="0-20">0-20åˆ†</option>
                        <option value="21-40">21-40åˆ†</option>
                        <option value="41-60">41-60åˆ†</option>
                        <option value="61-80">61-80åˆ†</option>
                        <option value="81-100">81-100åˆ†</option>
                    </select>
                </div>
                <button id="exportBtn" class="btn-primary px-6 py-2 rounded-lg text-white font-medium">
                    ğŸ“„ å¯¼å‡ºæ•°æ®
                </button>
            </div>
        </div>

        <!-- ç”¨æˆ·æ•°æ®è¡¨æ ¼ -->
        <div class="glass-card rounded-2xl p-8 shadow-2xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-800">ç”¨æˆ·æ•°æ®åˆ—è¡¨</h3>
                <div class="text-sm text-gray-600">
                    å…± <span id="totalCount">-</span> æ¡è®°å½•
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b border-gray-200">
                            <th class="text-left py-3 px-4 font-bold text-gray-800">ID</th>
                            <th class="text-left py-3 px-4 font-bold text-gray-800">å§“å</th>
                            <th class="text-left py-3 px-4 font-bold text-gray-800">å¹´çº§</th>
                            <th class="text-left py-3 px-4 font-bold text-gray-800">æ‰‹æœºå·</th>
                            <th class="text-left py-3 px-4 font-bold text-gray-800">æ€»åˆ†</th>
                            <th class="text-left py-3 px-4 font-bold text-gray-800">æ³¨å†Œæ—¶é—´</th>
                            <th class="text-left py-3 px-4 font-bold text-gray-800">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="userTableBody">
                        <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>

            <!-- åˆ†é¡µ -->
            <div class="flex justify-between items-center mt-6">
                <div class="text-sm text-gray-600">
                    æ˜¾ç¤ºç¬¬ <span id="pageStart">-</span> åˆ° <span id="pageEnd">-</span> æ¡ï¼Œå…± <span id="totalRecords">-</span> æ¡è®°å½•
                </div>
                <div class="flex space-x-2">
                    <button id="prevPage" class="px-4 py-2 bg-gray-200 rounded-lg text-gray-700 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
                        ä¸Šä¸€é¡µ
                    </button>
                    <span id="pageInfo" class="px-4 py-2 text-gray-700">ç¬¬ 1 é¡µ</span>
                    <button id="nextPage" class="px-4 py-2 bg-gray-200 rounded-lg text-gray-700 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
                        ä¸‹ä¸€é¡µ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="detailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="glass-card rounded-2xl p-8 shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-gray-800">ç”¨æˆ·è¯¦æƒ…</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <div id="modalContent">
                <!-- è¯¦æƒ…å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        let users = [];
        let filteredUsers = [];
        let currentPage = 1;
        const pageSize = 10;

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
        });

        // åŠ è½½æ•°æ®
        async function loadData() {
            try {
                // åŠ è½½ç»Ÿè®¡æ•°æ®
                const statsResponse = await fetch('/api/admin/stats');
                const stats = await statsResponse.json();
                
                document.getElementById('totalUsers').textContent = stats.totalUsers || 0;
                document.getElementById('totalAssessments').textContent = stats.totalAssessments || 0;
                document.getElementById('averageScore').textContent = stats.averageScore || 0;
                document.getElementById('completionRate').textContent = 
                    stats.totalUsers > 0 ? Math.round((stats.totalAssessments / stats.totalUsers) * 100) + '%' : '0%';

                // åŠ è½½ç”¨æˆ·æ•°æ®
                const usersResponse = await fetch('/api/admin/users');
                users = await usersResponse.json();
                filteredUsers = [...users];
                
                renderTable();
                renderCharts();
                animatePageLoad();
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                alert('æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // æœç´¢å’Œç­›é€‰
            document.getElementById('searchInput').addEventListener('input', filterData);
            document.getElementById('gradeFilter').addEventListener('change', filterData);
            document.getElementById('scoreFilter').addEventListener('change', filterData);
            
            // å¯¼å‡ºæŒ‰é’®
            document.getElementById('exportBtn').addEventListener('click', exportData);
            
            // åˆ†é¡µæŒ‰é’®
            document.getElementById('prevPage').addEventListener('click', () => changePage(-1));
            document.getElementById('nextPage').addEventListener('click', () => changePage(1));
            
            // æ¨¡æ€æ¡†
            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('detailModal').addEventListener('click', (e) => {
                if (e.target === e.currentTarget) closeModal();
            });
        }

        // ç­›é€‰æ•°æ®
        function filterData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const gradeFilter = document.getElementById('gradeFilter').value;
            const scoreFilter = document.getElementById('scoreFilter').value;
            
            filteredUsers = users.filter(user => {
                // æœç´¢ç­›é€‰
                const matchesSearch = !searchTerm || 
                    user.username.toLowerCase().includes(searchTerm) || 
                    user.phone.includes(searchTerm);
                
                // å¹´çº§ç­›é€‰
                const matchesGrade = !gradeFilter || user.grade === gradeFilter;
                
                // åˆ†æ•°ç­›é€‰
                let matchesScore = true;
                if (scoreFilter && user.totalScore) {
                    const [min, max] = scoreFilter.split('-').map(Number);
                    matchesScore = user.totalScore >= min && user.totalScore <= max;
                }
                
                return matchesSearch && matchesGrade && matchesScore;
            });
            
            currentPage = 1;
            renderTable();
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable() {
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = startIndex + pageSize;
            const pageUsers = filteredUsers.slice(startIndex, endIndex);
            
            const tbody = document.getElementById('userTableBody');
            tbody.innerHTML = '';
            
            pageUsers.forEach(user => {
                const row = document.createElement('tr');
                row.className = 'table-row border-b border-gray-100';
                row.innerHTML = `
                    <td class="py-3 px-4 text-gray-800">${user.id}</td>
                    <td class="py-3 px-4 text-gray-800 font-medium">${user.username}</td>
                    <td class="py-3 px-4 text-gray-600">${user.grade}</td>
                    <td class="py-3 px-4 text-gray-600">${user.phone}</td>
                    <td class="py-3 px-4">
                        ${user.totalScore ? 
                            `<span class="inline-block px-2 py-1 rounded-full text-sm font-medium ${getScoreColor(user.totalScore)}">${user.totalScore}</span>` : 
                            '<span class="text-gray-400">æœªæµ‹è¯„</span>'
                        }
                    </td>
                    <td class="py-3 px-4 text-gray-600">${new Date(user.userTime).toLocaleDateString('zh-CN')}</td>
                    <td class="py-3 px-4">
                        <button onclick="showDetail(${user.id})" class="text-blue-600 hover:text-blue-800 mr-3">è¯¦æƒ…</button>
                        <button onclick="deleteUser(${user.id})" class="text-red-600 hover:text-red-800">åˆ é™¤</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
            
            // æ›´æ–°åˆ†é¡µä¿¡æ¯
            updatePagination();
        }

        // æ›´æ–°åˆ†é¡µä¿¡æ¯
        function updatePagination() {
            const totalPages = Math.ceil(filteredUsers.length / pageSize);
            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = Math.min(startIndex + pageSize, filteredUsers.length);
            
            document.getElementById('totalCount').textContent = filteredUsers.length;
            document.getElementById('totalRecords').textContent = filteredUsers.length;
            document.getElementById('pageStart').textContent = startIndex + 1;
            document.getElementById('pageEnd').textContent = endIndex;
            document.getElementById('pageInfo').textContent = `ç¬¬ ${currentPage} é¡µ`;
            
            document.getElementById('prevPage').disabled = currentPage === 1;
            document.getElementById('nextPage').disabled = currentPage === totalPages;
        }

        // åˆ‡æ¢é¡µé¢
        function changePage(direction) {
            const totalPages = Math.ceil(filteredUsers.length / pageSize);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                renderTable();
            }
        }

        // è·å–åˆ†æ•°é¢œè‰²
        function getScoreColor(score) {
            if (score >= 80) return 'bg-green-100 text-green-800';
            if (score >= 60) return 'bg-blue-100 text-blue-800';
            if (score >= 40) return 'bg-yellow-100 text-yellow-800';
            return 'bg-red-100 text-red-800';
        }

        // æ˜¾ç¤ºç”¨æˆ·è¯¦æƒ…
        function showDetail(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            
            content.innerHTML = `
                <div class="space-y-4">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å§“å</label>
                            <div class="text-gray-900">${user.username}</div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">å¹´çº§</label>
                            <div class="text-gray-900">${user.grade}</div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">æ‰‹æœºå·</label>
                            <div class="text-gray-900">${user.phone}</div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">æ³¨å†Œæ—¶é—´</label>
                            <div class="text-gray-900">${new Date(user.userTime).toLocaleString('zh-CN')}</div>
                        </div>
                    </div>
                    
                    ${user.totalScore ? `
                        <div class="border-t pt-4">
                            <h4 class="font-bold text-gray-800 mb-3">æµ‹è¯„ç»“æœ</h4>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">æ€»åˆ†</label>
                                    <div class="text-2xl font-bold text-blue-600">${user.totalScore} / 100</div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">æµ‹è¯„æ—¶é—´</label>
                                    <div class="text-gray-900">${user.assessmentTime ? new Date(user.assessmentTime).toLocaleString('zh-CN') : '-'}</div>
                                </div>
                            </div>
                            
                            ${user.moduleScores ? `
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">å„æ¨¡å—å¾—åˆ†</label>
                                    <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                                        ${Object.entries(user.moduleScores).map(([module, score]) => `
                                            <div class="bg-gray-50 p-2 rounded text-center">
                                                <div class="text-xs text-gray-600">${module}</div>
                                                <div class="font-bold text-gray-800">${score.toFixed(1)}</div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    ` : `
                        <div class="border-t pt-4">
                            <div class="text-center text-gray-500 py-8">
                                <div class="text-4xl mb-2">ğŸ“‹</div>
                                <div>è¯¥ç”¨æˆ·å°šæœªå®Œæˆæµ‹è¯„</div>
                            </div>
                        </div>
                    `}
                </div>
            `;
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            const modal = document.getElementById('detailModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // åˆ é™¤ç”¨æˆ·
        function deleteUser(userId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¯¥ç”¨æˆ·å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                return;
            }
            
            fetch(`/api/admin/users/${userId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('åˆ é™¤å¤±è´¥ï¼š' + data.error);
                } else {
                    alert('åˆ é™¤æˆåŠŸï¼');
                    loadData(); // é‡æ–°åŠ è½½æ•°æ®
                }
            })
            .catch(error => {
                console.error('åˆ é™¤å¤±è´¥:', error);
                alert('åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•');
            });
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            if (filteredUsers.length === 0) {
                alert('æ²¡æœ‰æ•°æ®å¯å¯¼å‡º');
                return;
            }
            
            const csvContent = generateCSV(filteredUsers);
            downloadCSV(csvContent, 'user_data.csv');
        }

        // ç”ŸæˆCSVå†…å®¹
        function generateCSV(users) {
            const headers = ['ID', 'å§“å', 'å¹´çº§', 'æ‰‹æœºå·', 'æ€»åˆ†', 'åˆ›é€ åŠ›', 'æŠ€æœ¯èƒ½åŠ›', 'ä»»åŠ¡ç†è§£', 'ç¤¾äº¤åº”å˜', 'é—®é¢˜åˆ†æ', 'æ³¨å†Œæ—¶é—´', 'æµ‹è¯„æ—¶é—´'];
            const rows = [headers.join(',')];
            
            users.forEach(user => {
                const row = [
                    user.id,
                    user.username,
                    user.grade,
                    user.phone,
                    user.totalScore || '',
                    user.moduleScores?.åˆ›é€ åŠ›?.toFixed(1) || '',
                    user.moduleScores?.æŠ€æœ¯èƒ½åŠ›?.toFixed(1) || '',
                    user.moduleScores?.ä»»åŠ¡ç†è§£ä¸æ‰§è¡Œ?.toFixed(1) || '',
                    user.moduleScores?.ç¤¾äº¤ä¸åº”å˜?.toFixed(1) || '',
                    user.moduleScores?.é—®é¢˜æ‹†è§£ä¸åˆ†æ?.toFixed(1) || '',
                    new Date(user.userTime).toLocaleDateString('zh-CN'),
                    user.assessmentTime ? new Date(user.assessmentTime).toLocaleDateString('zh-CN') : ''
                ];
                rows.push(row.join(','));
            });
            
            return rows.join('\n');
        }

        // ä¸‹è½½CSVæ–‡ä»¶
        function downloadCSV(content, filename) {
            const blob = new Blob(['\uFEFF' + content], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // æ¸²æŸ“å›¾è¡¨
        function renderCharts() {
            renderScoreChart();
            renderGradeChart();
        }

        // æ¸²æŸ“åˆ†æ•°åˆ†å¸ƒå›¾
        function renderScoreChart() {
            const chartDom = document.getElementById('scoreChart');
            const myChart = echarts.init(chartDom);
            
            // ç»Ÿè®¡åˆ†æ•°åˆ†å¸ƒ
            const scoreRanges = ['0-20', '21-40', '41-60', '61-80', '81-100'];
            const scoreCounts = scoreRanges.map(range => {
                const [min, max] = range.split('-').map(Number);
                return users.filter(user => user.totalScore && user.totalScore >= min && user.totalScore <= max).length;
            });
            
            const option = {
                title: {
                    text: 'åˆ†æ•°åˆ†å¸ƒ',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c}äºº ({d}%)'
                },
                series: [{
                    type: 'pie',
                    radius: '70%',
                    data: scoreRanges.map((range, index) => ({
                        value: scoreCounts[index],
                        name: range + 'åˆ†'
                    })),
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };
            
            myChart.setOption(option);
        }

        // æ¸²æŸ“å¹´çº§åˆ†å¸ƒå›¾
        function renderGradeChart() {
            const chartDom = document.getElementById('gradeChart');
            const myChart = echarts.init(chartDom);
            
            // ç»Ÿè®¡å¹´çº§åˆ†å¸ƒ
            const gradeCounts = {};
            users.forEach(user => {
                gradeCounts[user.grade] = (gradeCounts[user.grade] || 0) + 1;
            });
            
            const option = {
                title: {
                    text: 'å¹´çº§åˆ†å¸ƒ',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                xAxis: {
                    type: 'category',
                    data: Object.keys(gradeCounts),
                    axisLabel: {
                        rotate: 45
                    }
                },
                yAxis: {
                    type: 'value'
                },
                series: [{
                    data: Object.values(gradeCounts),
                    type: 'bar',
                    itemStyle: {
                        color: '#3498db'
                    }
                }]
            };
            
            myChart.setOption(option);
        }

        // é¡µé¢åŠ è½½åŠ¨ç”»
        function animatePageLoad() {
            anime({
                targets: '.stat-card, .glass-card',
                translateY: [50, 0],
                opacity: [0, 1],
                duration: 800,
                delay: anime.stagger(100),
                easing: 'easeOutQuart'
            });
        }
    </script>
</body>
</html>