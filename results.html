<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯„ç»“æœ - å°±ä¸šç«äº‰åŠ›æŒ‡æ•°</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .hero-title {
            font-family: 'Noto Serif SC', serif;
            background: linear-gradient(45deg, #3498db, #27ae60);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .score-circle {
            background: conic-gradient(from 0deg, #3498db 0deg, #27ae60 var(--score-angle), #e0e0e0 var(--score-angle), #e0e0e0 360deg);
        }
        .module-card {
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        .module-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        .module-card.creativity { border-left-color: #e74c3c; }
        .module-card.technical { border-left-color: #3498db; }
        .module-card.execution { border-left-color: #f39c12; }
        .module-card.social { border-left-color: #9b59b6; }
        .module-card.analysis { border-left-color: #27ae60; }
        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(52, 152, 219, 0.4);
        }
        .level-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .level-beginner { background: #fee2e2; color: #dc2626; }
        .level-intermediate { background: #fef3c7; color: #d97706; }
        .level-advanced { background: #dcfce7; color: #16a34a; }
        .level-expert { background: #dbeafe; color: #2563eb; }
        .level-master { background: #f3e8ff; color: #9333ea; }
    </style>
</head>
<body class="py-8">
    <div class="container mx-auto px-4">
        <!-- å¤´éƒ¨æ ‡é¢˜ -->
        <div class="text-center mb-8">
            <h1 class="hero-title text-4xl font-bold mb-4">å°±ä¸šç«äº‰åŠ›æµ‹è¯„æŠ¥å‘Š</h1>
            <p class="text-white text-lg opacity-90">åŸºäºç§‘å­¦è¯„ä¼°çš„ä¸ªæ€§åŒ–å‘å±•å»ºè®®</p>
        </div>

        <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
        <div class="glass-card rounded-2xl p-6 shadow-2xl mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">
                        <span id="userName">-</span> çš„ç«äº‰åŠ›åˆ†ææŠ¥å‘Š
                    </h2>
                    <p class="text-gray-600">
                        å¹´çº§ï¼š<span id="userGrade">-</span> | æµ‹è¯„æ—¶é—´ï¼š<span id="assessmentTime">-</span>
                    </p>
                </div>
                <div class="text-right">
                    <div class="text-3xl font-bold text-blue-600">
                        <span id="totalScore">-</span> / 100
                    </div>
                    <div class="text-sm text-gray-500">ç»¼åˆå¾—åˆ†</div>
                </div>
            </div>
        </div>

        <!-- é›·è¾¾å›¾å’Œæ¨¡å—åˆ†æ -->
        <div class="grid lg:grid-cols-2 gap-8 mb-8">
            <!-- äº”ç»´é›·è¾¾å›¾ -->
            <div class="glass-card rounded-2xl p-8 shadow-2xl">
                <h3 class="text-xl font-bold text-gray-800 mb-6 text-center">èƒ½åŠ›é›·è¾¾å›¾</h3>
                <div id="radarChart" style="height: 400px;"></div>
            </div>

            <!-- æ¨¡å—å¾—åˆ†è¯¦æƒ… -->
            <div class="glass-card rounded-2xl p-8 shadow-2xl">
                <h3 class="text-xl font-bold text-gray-800 mb-6">æ¨¡å—å¾—åˆ†è¯¦æƒ…</h3>
                <div id="moduleScores" class="space-y-4">
                    <!-- æ¨¡å—å¾—åˆ†å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- ä¸ªæ€§åŒ–å»ºè®® -->
        <div class="glass-card rounded-2xl p-8 shadow-2xl mb-8">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸ¯ ä¸ªæ€§åŒ–å‘å±•å»ºè®®</h3>
            
            <!-- æ€»åˆ†æ¡£æ¬¡åˆ†æ -->
            <div class="mb-8 p-6 bg-gradient-to-r from-blue-50 to-green-50 rounded-xl">
                <h4 class="text-lg font-bold text-gray-800 mb-4">ğŸ“Š ç»¼åˆè¯„ä¼°</h4>
                <div id="totalScoreAnalysis">
                    <!-- æ€»åˆ†åˆ†æå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- å„æ¨¡å—å»ºè®® -->
            <div id="moduleSuggestions" class="space-y-6">
                <!-- æ¨¡å—å»ºè®®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- è¡ŒåŠ¨è®¡åˆ’ -->
        <div class="glass-card rounded-2xl p-8 shadow-2xl mb-8">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">ğŸš€ 90å¤©è¡ŒåŠ¨è®¡åˆ’</h3>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="text-center p-6 bg-red-50 rounded-xl">
                    <div class="text-2xl mb-2">ç¬¬1-30å¤©</div>
                    <h4 class="font-bold text-gray-800 mb-2">åŸºç¡€å¼ºåŒ–æœŸ</h4>
                    <p class="text-sm text-gray-600">é‡ç‚¹æå‡æœ€è–„å¼±ç¯èŠ‚ï¼Œå»ºç«‹å­¦ä¹ ä¹ æƒ¯</p>
                </div>
                <div class="text-center p-6 bg-yellow-50 rounded-xl">
                    <div class="text-2xl mb-2">ç¬¬31-60å¤©</div>
                    <h4 class="font-bold text-gray-800 mb-2">å®è·µåº”ç”¨æœŸ</h4>
                    <p class="text-sm text-gray-600">åœ¨å®é™…å·¥ä½œä¸­åº”ç”¨æ–°æŠ€èƒ½ï¼Œç§¯ç´¯ç»éªŒ</p>
                </div>
                <div class="text-center p-6 bg-green-50 rounded-xl">
                    <div class="text-2xl mb-2">ç¬¬61-90å¤©</div>
                    <h4 class="font-bold text-gray-800 mb-2">æå‡å±•ç¤ºæœŸ</h4>
                    <p class="text-sm text-gray-600">å±•ç¤ºå­¦ä¹ æˆæœï¼Œå¯»æ±‚æ›´å¤šå‘å±•æœºä¼š</p>
                </div>
            </div>
        </div>

        <!-- æ“ä½œæŒ‰é’® -->
        <div class="text-center space-x-4">
            <button id="downloadBtn" class="btn-primary px-8 py-3 rounded-lg text-white font-medium">
                ğŸ“„ ä¸‹è½½æŠ¥å‘Š
            </button>
            <button id="shareBtn" class="btn-primary px-8 py-3 rounded-lg text-white font-medium">
                ğŸ“¤ åˆ†äº«ç»“æœ
            </button>
            <button id="restartBtn" class="btn-primary px-8 py-3 rounded-lg text-white font-medium">
                ğŸ”„ é‡æ–°æµ‹è¯„
            </button>
        </div>
    </div>

    <script>
        let results = {};
        let suggestions = {};
        let userInfo = {};

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            // è·å–ç”¨æˆ·ä¿¡æ¯å’Œæµ‹è¯„ç»“æœ
            userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');
            results = JSON.parse(localStorage.getItem('assessmentResults') || '{}');
            
            if (!userInfo.username || !results.moduleScores) {
                window.location.href = 'index.html';
                return;
            }

            // åŠ è½½å»ºè®®æ•°æ®
            try {
                const response = await fetch('suggestions.json');
                suggestions = await response.json();
            } catch (error) {
                console.error('åŠ è½½å»ºè®®æ•°æ®å¤±è´¥:', error);
            }

            // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
            displayUserInfo();
            
            // æ˜¾ç¤ºé›·è¾¾å›¾
            displayRadarChart();
            
            // æ˜¾ç¤ºæ¨¡å—å¾—åˆ†
            displayModuleScores();
            
            // æ˜¾ç¤ºå»ºè®®
            displaySuggestions();
            
            // é¡µé¢åŠ è½½åŠ¨ç”»
            animatePageLoad();
        });

        // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
        function displayUserInfo() {
            document.getElementById('userName').textContent = userInfo.username;
            document.getElementById('userGrade').textContent = userInfo.grade;
            document.getElementById('assessmentTime').textContent = new Date().toLocaleDateString('zh-CN');
            document.getElementById('totalScore').textContent = results.totalScore;
        }

        // æ˜¾ç¤ºé›·è¾¾å›¾
        function displayRadarChart() {
            const chartDom = document.getElementById('radarChart');
            const myChart = echarts.init(chartDom);
            
            const modules = Object.keys(results.moduleScores);
            const scores = modules.map(module => results.moduleScores[module]);
            const maxScores = new Array(modules.length).fill(5);
            
            const option = {
                title: {
                    text: 'èƒ½åŠ›åˆ†å¸ƒé›·è¾¾å›¾',
                    left: 'center',
                    textStyle: {
                        fontSize: 16,
                        fontWeight: 'bold'
                    }
                },
                radar: {
                    indicator: modules.map(module => ({
                        name: module,
                        max: 5
                    })),
                    radius: '70%',
                    axisName: {
                        fontSize: 14,
                        fontWeight: 'bold'
                    },
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(52, 152, 219, 0.1)', 'rgba(39, 174, 96, 0.1)']
                        }
                    }
                },
                series: [{
                    name: 'èƒ½åŠ›å€¼',
                    type: 'radar',
                    data: [
                        {
                            value: scores,
                            name: 'æ‚¨çš„èƒ½åŠ›',
                            areaStyle: {
                                color: 'rgba(52, 152, 219, 0.3)'
                            },
                            lineStyle: {
                                color: '#3498db',
                                width: 3
                            },
                            itemStyle: {
                                color: '#3498db'
                            }
                        },
                        {
                            value: maxScores,
                            name: 'æ»¡åˆ†æ ‡å‡†',
                            lineStyle: {
                                color: '#27ae60',
                                width: 2,
                                type: 'dashed'
                            },
                            itemStyle: {
                                color: '#27ae60'
                            },
                        }
                    ]
                }],
                legend: {
                    bottom: 10,
                    data: ['æ‚¨çš„èƒ½åŠ›', 'æ»¡åˆ†æ ‡å‡†']
                }
            };
            
            myChart.setOption(option);
            
            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }

        // æ˜¾ç¤ºæ¨¡å—å¾—åˆ†
        function displayModuleScores() {
            const container = document.getElementById('moduleScores');
            container.innerHTML = '';
            
            const moduleClasses = {
                'åˆ›é€ åŠ›': 'creativity',
                'æŠ€æœ¯èƒ½åŠ›': 'technical',
                'ä»»åŠ¡ç†è§£ä¸æ‰§è¡Œ': 'execution',
                'ç¤¾äº¤ä¸åº”å˜': 'social',
                'é—®é¢˜æ‹†è§£ä¸åˆ†æ': 'analysis'
            };
            
            Object.entries(results.moduleScores).forEach(([module, score]) => {
                const percentage = (score / 5) * 100;
                const level = getScoreLevel(score, 5);
                
                const moduleCard = document.createElement('div');
                moduleCard.className = `module-card ${moduleClasses[module]} bg-white p-4 rounded-lg shadow-sm`;
                moduleCard.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="font-bold text-gray-800">${module}</h4>
                        <span class="level-badge ${getLevelBadgeClass(level)}">${level}</span>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="flex-1">
                            <div class="bg-gray-200 rounded-full h-3 overflow-hidden">
                                <div class="h-full rounded-full transition-all duration-1000" 
                                     style="width: ${percentage}%; background: linear-gradient(90deg, #3498db, #27ae60);"></div>
                            </div>
                        </div>
                        <div class="text-lg font-bold text-gray-800 min-w-[60px]">
                            ${score.toFixed(1)} / 5.0
                        </div>
                    </div>
                `;
                container.appendChild(moduleCard);
            });
        }

        // è·å–åˆ†æ•°ç­‰çº§
        function getScoreLevel(score, maxScore = 5) {
            const percentage = (score / maxScore) * 100;
            if (percentage >= 80) return 'ä¸“å®¶';
            if (percentage >= 60) return 'é«˜çº§';
            if (percentage >= 40) return 'ä¸­çº§';
            if (percentage >= 20) return 'å…¥é—¨';
            return 'åˆçº§';
        }

        // è·å–ç­‰çº§å¾½ç« æ ·å¼
        function getLevelBadgeClass(level) {
            const classes = {
                'åˆçº§': 'level-beginner',
                'å…¥é—¨': 'level-beginner',
                'ä¸­çº§': 'level-intermediate',
                'é«˜çº§': 'level-advanced',
                'ä¸“å®¶': 'level-expert'
            };
            return classes[level] || 'level-beginner';
        }

        // æ˜¾ç¤ºå»ºè®®
        function displaySuggestions() {
            // æ€»åˆ†æ¡£æ¬¡åˆ†æ
            const totalScoreAnalysis = document.getElementById('totalScoreAnalysis');
            const totalScoreRange = getScoreRange(results.totalScore, 100);
            const totalSuggestion = suggestions.totalScore?.[totalScoreRange];
            
            if (totalSuggestion) {
                totalScoreAnalysis.innerHTML = `
                    <div class="mb-4">
                        <span class="level-badge ${getLevelBadgeClass(getScoreLevel(results.totalScore, 100))}">
                            ${getScoreRangeText(results.totalScore, 100)}
                        </span>
                    </div>
                    <p class="text-gray-700 mb-3">${totalSuggestion.summary}</p>
                    <p class="text-blue-700 font-medium">${totalSuggestion.recommendation}</p>
                `;
            }
            
            // å„æ¨¡å—å»ºè®®
            const moduleSuggestions = document.getElementById('moduleSuggestions');
            moduleSuggestions.innerHTML = '';
            
            Object.entries(results.moduleScores).forEach(([module, score]) => {
                const scoreRange = getScoreRange(score, 5);
                const moduleSuggestion = suggestions.modules?.[module]?.[scoreRange];
                
                if (moduleSuggestion) {
                    const suggestionCard = document.createElement('div');
                    suggestionCard.className = 'module-card bg-white p-6 rounded-xl shadow-sm';
                    suggestionCard.innerHTML = `
                        <div class="flex items-center mb-4">
                            <h4 class="text-lg font-bold text-gray-800 mr-3">${module}</h4>
                            <span class="level-badge ${getLevelBadgeClass(moduleSuggestion.level)}">${moduleSuggestion.level}</span>
                        </div>
                        <p class="text-gray-700 mb-2">${moduleSuggestion.description}</p>
                        <p class="text-blue-700 font-medium">${moduleSuggestion.suggestion}</p>
                    `;
                    moduleSuggestions.appendChild(suggestionCard);
                }
            });
        }

        // è·å–åˆ†æ•°èŒƒå›´
        function getScoreRange(score, maxScore = 5) {
            const ranges = maxScore === 100 ? 
                ['0-20', '21-40', '41-60', '61-80', '81-100'] :
                ['0-1', '1-2', '2-3', '3-4', '4-5'];
            
            const percentage = (score / maxScore) * 100;
            const rangeIndex = Math.min(Math.floor(percentage / 20), 4);
            return ranges[rangeIndex];
        }

        // è·å–åˆ†æ•°èŒƒå›´æ–‡æœ¬
        function getScoreRangeText(score, maxScore = 5) {
            if (maxScore === 100) {
                if (score <= 20) return '0-20åˆ†';
                if (score <= 40) return '21-40åˆ†';
                if (score <= 60) return '41-60åˆ†';
                if (score <= 80) return '61-80åˆ†';
                return '81-100åˆ†';
            } else {
                if (score <= 1) return '0-1åˆ†';
                if (score <= 2) return '1-2åˆ†';
                if (score <= 3) return '2-3åˆ†';
                if (score <= 4) return '3-4åˆ†';
                return '4-5åˆ†';
            }
        }

        // é¡µé¢åŠ è½½åŠ¨ç”»
        function animatePageLoad() {
            anime({
                targets: '.glass-card',
                translateY: [50, 0],
                opacity: [0, 1],
                duration: 800,
                delay: anime.stagger(200),
                easing: 'easeOutQuart'
            });
        }

        // æŒ‰é’®äº‹ä»¶å¤„ç†
        document.getElementById('downloadBtn').addEventListener('click', function() {
            // ç”ŸæˆPDFæŠ¥å‘Šï¼ˆè¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿï¼‰
            alert('æŠ¥å‘Šä¸‹è½½åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
        });

        document.getElementById('shareBtn').addEventListener('click', function() {
            if (navigator.share) {
                navigator.share({
                    title: 'æˆ‘çš„å°±ä¸šç«äº‰åŠ›æµ‹è¯„æŠ¥å‘Š',
                    text: `æˆ‘åœ¨å°±ä¸šç«äº‰åŠ›æµ‹è¯„ä¸­è·å¾—äº†${results.totalScore}åˆ†ï¼`,
                    url: window.location.href
                });
            } else {
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                const text = `æˆ‘åœ¨å°±ä¸šç«äº‰åŠ›æµ‹è¯„ä¸­è·å¾—äº†${results.totalScore}åˆ†ï¼å¿«æ¥æµ‹è¯•ä½ çš„å°±ä¸šç«äº‰åŠ›å§ï¼`;
                navigator.clipboard.writeText(text).then(() => {
                    alert('åˆ†äº«å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            }
        });

        document.getElementById('restartBtn').addEventListener('click', function() {
            if (confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹æµ‹è¯„å—ï¼Ÿå½“å‰ç»“æœå°†ä¼šä¸¢å¤±ã€‚')) {
                localStorage.removeItem('assessmentResults');
                window.location.href = 'assessment.html';
            }
        });
    </script>
</body>
</html>