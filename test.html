<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç³»ç»Ÿæµ‹è¯• - å°±ä¸šç«äº‰åŠ›æµ‹è¯„</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .btn-primary {
            background: linear-gradient(45deg, #3498db, #2980b9);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(52, 152, 219, 0.4);
        }
        .btn-success {
            background: linear-gradient(45deg, #27ae60, #229954);
            transition: all 0.3s ease;
        }
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(39, 174, 96, 0.4);
        }
        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            transition: all 0.3s ease;
        }
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(243, 156, 18, 0.4);
        }
        .status-success { color: #27ae60; }
        .status-error { color: #e74c3c; }
        .status-warning { color: #f39c12; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- æ ‡é¢˜ -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-4">ç³»ç»ŸåŠŸèƒ½æµ‹è¯•</h1>
                <p class="text-white text-lg opacity-90">æµ‹è¯•å„é¡¹åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
            </div>

            <!-- æµ‹è¯•é¡¹ç›® -->
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <!-- é¡µé¢è·³è½¬æµ‹è¯• -->
                <div class="glass-card rounded-2xl p-6 shadow-2xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸŒ é¡µé¢è·³è½¬æµ‹è¯•</h3>
                    <div class="space-y-3">
                        <button onclick="testPage('index.html')" class="btn-primary w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•é¦–é¡µ
                        </button>
                        <button onclick="testPage('assessment.html')" class="btn-primary w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•æµ‹è¯„é¡µ
                        </button>
                        <button onclick="testPage('results.html')" class="btn-primary w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•ç»“æœé¡µ
                        </button>
                        <button onclick="testPage('admin.html')" class="btn-primary w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•åå°
                        </button>
                    </div>
                    <div id="pageTestResult" class="mt-4 text-sm"></div>
                </div>

                <!-- æœ¬åœ°å­˜å‚¨æµ‹è¯• -->
                <div class="glass-card rounded-2xl p-6 shadow-2xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ’¾ æœ¬åœ°å­˜å‚¨æµ‹è¯•</h3>
                    <div class="space-y-3">
                        <button onclick="testLocalStorage()" class="btn-success w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•å­˜å‚¨åŠŸèƒ½
                        </button>
                        <button onclick="clearLocalStorage()" class="btn-warning w-full py-2 px-4 rounded-lg text-white">
                            æ¸…é™¤æµ‹è¯•æ•°æ®
                        </button>
                    </div>
                    <div id="storageTestResult" class="mt-4 text-sm"></div>
                </div>

                <!-- æ•°æ®éªŒè¯æµ‹è¯• -->
                <div class="glass-card rounded-2xl p-6 shadow-2xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">âœ… æ•°æ®éªŒè¯æµ‹è¯•</h3>
                    <div class="space-y-3">
                        <div>
                            <input type="text" id="testPhone" placeholder="æµ‹è¯•æ‰‹æœºå·" 
                                   class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:border-blue-500">
                        </div>
                        <button onclick="testPhoneValidation()" class="btn-success w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•æ‰‹æœºå·éªŒè¯
                        </button>
                    </div>
                    <div id="validationTestResult" class="mt-4 text-sm"></div>
                </div>

                <!-- ç³»ç»ŸåŠŸèƒ½æµ‹è¯• -->
                <div class="glass-card rounded-2xl p-6 shadow-2xl">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">âš™ï¸ ç³»ç»ŸåŠŸèƒ½æµ‹è¯•</h3>
                    <div class="space-y-3">
                        <button onclick="testSystemFunctions()" class="btn-success w-full py-2 px-4 rounded-lg text-white">
                            æµ‹è¯•ç³»ç»ŸåŠŸèƒ½
                        </button>
                        <button onclick="checkSystemStatus()" class="btn-warning w-full py-2 px-4 rounded-lg text-white">
                            æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
                        </button>
                    </div>
                    <div id="systemTestResult" class="mt-4 text-sm"></div>
                </div>
            </div>

            <!-- æµ‹è¯•ç»“æœæ±‡æ€» -->
            <div class="glass-card rounded-2xl p-6 shadow-2xl">
                <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“Š æµ‹è¯•ç»“æœæ±‡æ€»</h3>
                <div id="testSummary" class="space-y-2">
                    <div class="text-gray-600">ç­‰å¾…æµ‹è¯•...</div>
                </div>
            </div>

            <!-- å¿«é€Ÿæ“ä½œ -->
            <div class="text-center mt-8 space-x-4">
                <button onclick="runAllTests()" class="btn-success px-8 py-3 rounded-lg text-white font-medium">
                    ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•
                </button>
                <button onclick="window.location.href='index.html'" class="btn-primary px-8 py-3 rounded-lg text-white font-medium">
                    ğŸ  è¿”å›é¦–é¡µ
                </button>
            </div>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        let testResults = [];

        // æµ‹è¯•é¡µé¢è·³è½¬
        function testPage(page) {
            const resultDiv = document.getElementById('pageTestResult');
            
            // åœ¨æ–°çª—å£ä¸­æ‰“å¼€é¡µé¢æµ‹è¯•
            const testWindow = window.open(page, '_blank');
            
            if (testWindow) {
                resultDiv.innerHTML = `<span class="status-success">âœ“ ${page} æ‰“å¼€æˆåŠŸ</span>`;
                addTestResult('é¡µé¢è·³è½¬', `${page} å¯æ­£å¸¸è®¿é—®`, 'success');
                
                // 3ç§’åå…³é—­æµ‹è¯•çª—å£
                setTimeout(() => {
                    testWindow.close();
                }, 3000);
            } else {
                resultDiv.innerHTML = `<span class="status-error">âœ— ${page} æ‰“å¼€å¤±è´¥</span>`;
                addTestResult('é¡µé¢è·³è½¬', `${page} æ— æ³•è®¿é—®`, 'error');
            }
        }

        // æµ‹è¯•æœ¬åœ°å­˜å‚¨
        function testLocalStorage() {
            const resultDiv = document.getElementById('storageTestResult');
            
            try {
                // æµ‹è¯•å­˜å‚¨
                const testData = {
                    username: 'æµ‹è¯•ç”¨æˆ·',
                    grade: 'å¤§å››',
                    phone: '13800138000',
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('test_user', JSON.stringify(testData));
                
                // æµ‹è¯•è¯»å–
                const retrievedData = JSON.parse(localStorage.getItem('test_user'));
                
                if (retrievedData.username === testData.username) {
                    resultDiv.innerHTML = `<span class="status-success">âœ“ æœ¬åœ°å­˜å‚¨åŠŸèƒ½æ­£å¸¸</span>`;
                    addTestResult('æœ¬åœ°å­˜å‚¨', 'æ•°æ®å­˜å‚¨å’Œè¯»å–æ­£å¸¸', 'success');
                } else {
                    throw new Error('æ•°æ®ä¸åŒ¹é…');
                }
            } catch (error) {
                resultDiv.innerHTML = `<span class="status-error">âœ— æœ¬åœ°å­˜å‚¨å¤±è´¥: ${error.message}</span>`;
                addTestResult('æœ¬åœ°å­˜å‚¨', `å­˜å‚¨åŠŸèƒ½å¼‚å¸¸: ${error.message}`, 'error');
            }
        }

        // æ¸…é™¤æµ‹è¯•æ•°æ®
        function clearLocalStorage() {
            localStorage.removeItem('test_user');
            document.getElementById('storageTestResult').innerHTML = 
                `<span class="status-warning">âš  æµ‹è¯•æ•°æ®å·²æ¸…é™¤</span>`;
            addTestResult('æ¸…é™¤æ•°æ®', 'æµ‹è¯•æ•°æ®æ¸…é™¤å®Œæˆ', 'warning');
        }

        // æµ‹è¯•æ‰‹æœºå·éªŒè¯
        function testPhoneValidation() {
            const phone = document.getElementById('testPhone').value;
            const resultDiv = document.getElementById('validationTestResult');
            
            if (!phone) {
                resultDiv.innerHTML = `<span class="status-warning">âš  è¯·è¾“å…¥æ‰‹æœºå·</span>`;
                return;
            }
            
            const isValid = validatePhone(phone);
            
            if (isValid) {
                resultDiv.innerHTML = `<span class="status-success">âœ“ æ‰‹æœºå·æ ¼å¼æ­£ç¡®</span>`;
                addTestResult('æ‰‹æœºå·éªŒè¯', `${phone} æ ¼å¼æ­£ç¡®`, 'success');
            } else {
                resultDiv.innerHTML = `<span class="status-error">âœ— æ‰‹æœºå·æ ¼å¼é”™è¯¯</span>`;
                addTestResult('æ‰‹æœºå·éªŒè¯', `${phone} æ ¼å¼é”™è¯¯`, 'error');
            }
        }

        // æµ‹è¯•ç³»ç»ŸåŠŸèƒ½
        function testSystemFunctions() {
            const resultDiv = document.getElementById('systemTestResult');
            let results = [];
            
            // æµ‹è¯•ç³»ç»Ÿæ˜¯å¦å­˜åœ¨
            if (window.assessmentSystem) {
                results.push('âœ“ æµ‹è¯„ç³»ç»Ÿå®ä¾‹å­˜åœ¨');
            } else {
                results.push('âœ— æµ‹è¯„ç³»ç»Ÿå®ä¾‹ä¸å­˜åœ¨');
            }
            
            // æµ‹è¯•å·¥å…·å‡½æ•°
            if (typeof validatePhone === 'function') {
                results.push('âœ“ éªŒè¯å‡½æ•°å¯ç”¨');
            } else {
                results.push('âœ— éªŒè¯å‡½æ•°ä¸å¯ç”¨');
            }
            
            // æµ‹è¯•å­˜å‚¨å·¥å…·
            if (window.StorageUtil) {
                results.push('âœ“ å­˜å‚¨å·¥å…·å¯ç”¨');
            } else {
                results.push('âœ— å­˜å‚¨å·¥å…·ä¸å¯ç”¨');
            }
            
            resultDiv.innerHTML = `<div class="text-sm">${results.join('<br>')}</div>`;
            addTestResult('ç³»ç»ŸåŠŸèƒ½', `åŠŸèƒ½æ£€æµ‹å®Œæˆ - ${results.length}é¡¹é€šè¿‡`, 'success');
        }

        // æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
        function checkSystemStatus() {
            const resultDiv = document.getElementById('systemTestResult');
            
            const status = {
                userAgent: navigator.userAgent,
                localStorage: typeof Storage !== 'undefined',
                cookies: navigator.cookieEnabled,
                online: navigator.onLine,
                timestamp: new Date().toLocaleString('zh-CN')
            };
            
            let html = '<div class="text-sm space-y-1">';
            html += `<div><strong>ç”¨æˆ·ä»£ç†:</strong> ${status.userAgent}</div>`;
            html += `<div><strong>æœ¬åœ°å­˜å‚¨:</strong> ${status.localStorage ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ'}</div>`;
            html += `<div><strong>Cookies:</strong> ${status.cookies ? 'å¯ç”¨' : 'ç¦ç”¨'}</div>`;
            html += `<div><strong>ç½‘ç»œçŠ¶æ€:</strong> ${status.online ? 'åœ¨çº¿' : 'ç¦»çº¿'}</div>`;
            html += `<div><strong>æ£€æŸ¥æ—¶é—´:</strong> ${status.timestamp}</div>`;
            html += '</div>';
            
            resultDiv.innerHTML = html;
            addTestResult('ç³»ç»ŸçŠ¶æ€', 'çŠ¶æ€æ£€æŸ¥å®Œæˆ', 'success');
        }

        // æ·»åŠ æµ‹è¯•ç»“æœ
        function addTestResult(category, description, status) {
            testResults.push({
                category,
                description,
                status,
                timestamp: new Date().toLocaleTimeString('zh-CN')
            });
            
            updateTestSummary();
        }

        // æ›´æ–°æµ‹è¯•æ±‡æ€»
        function updateTestSummary() {
            const summaryDiv = document.getElementById('testSummary');
            
            if (testResults.length === 0) {
                summaryDiv.innerHTML = '<div class="text-gray-600">æš‚æ— æµ‹è¯•ç»“æœ</div>';
                return;
            }
            
            const successCount = testResults.filter(r => r.status === 'success').length;
            const errorCount = testResults.filter(r => r.status === 'error').length;
            const warningCount = testResults.filter(r => r.status === 'warning').length;
            
            let html = `
                <div class="grid grid-cols-3 gap-4 mb-4">
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <div class="text-2xl font-bold text-green-600">${successCount}</div>
                        <div class="text-sm text-green-700">æˆåŠŸ</div>
                    </div>
                    <div class="text-center p-3 bg-yellow-50 rounded-lg">
                        <div class="text-2xl font-bold text-yellow-600">${warningCount}</div>
                        <div class="text-sm text-yellow-700">è­¦å‘Š</div>
                    </div>
                    <div class="text-center p-3 bg-red-50 rounded-lg">
                        <div class="text-2xl font-bold text-red-600">${errorCount}</div>
                        <div class="text-sm text-red-700">é”™è¯¯</div>
                    </div>
                </div>
            `;
            
            // æ˜¾ç¤ºæœ€è¿‘5æ¡æµ‹è¯•ç»“æœ
            const recentResults = testResults.slice(-5);
            html += '<div class="space-y-2 max-h-40 overflow-y-auto">';
            recentResults.forEach(result => {
                const statusColor = {
                    success: 'text-green-600',
                    warning: 'text-yellow-600',
                    error: 'text-red-600'
                };
                
                html += `
                    <div class="flex justify-between items-center text-sm p-2 bg-gray-50 rounded">
                        <div>
                            <span class="font-medium ${statusColor[result.status]}">[${result.category}]</span>
                            <span class="text-gray-700">${result.description}</span>
                        </div>
                        <span class="text-gray-500">${result.timestamp}</span>
                    </div>
                `;
            });
            html += '</div>';
            
            summaryDiv.innerHTML = html;
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        function runAllTests() {
            testResults = []; // æ¸…ç©ºä¹‹å‰çš„æµ‹è¯•ç»“æœ
            
            // æŒ‰é¡ºåºæ‰§è¡Œæµ‹è¯•
            setTimeout(() => testLocalStorage(), 500);
            setTimeout(() => testPhoneValidation(), 1000);
            setTimeout(() => testSystemFunctions(), 1500);
            setTimeout(() => checkSystemStatus(), 2000);
            
            // æ˜¾ç¤ºæµ‹è¯•è¿›åº¦
            const summaryDiv = document.getElementById('testSummary');
            summaryDiv.innerHTML = '<div class="text-blue-600">ğŸ”„ æ­£åœ¨è¿è¡Œæµ‹è¯•...</div>';
            
            // æµ‹è¯•å®Œæˆåæ›´æ–°æ±‡æ€»
            setTimeout(() => {
                updateTestSummary();
            }, 2500);
        }

        // åˆå§‹åŒ–æµ‹è¯•é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // æ·»åŠ æµ‹è¯•æ‰‹æœºå·ç¤ºä¾‹
            document.getElementById('testPhone').value = '13800138000';
            
            console.log('æµ‹è¯•é¡µé¢å·²åŠ è½½');
        });
    </script>
</body>
</html>